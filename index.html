<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Side A</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#18120e;
  --panel:#2b2019;
  --accent:#c58a2b;
  --label:#efe4d2;
  --text:#f3eee6;
}

*{margin:0;padding:0;box-sizing:border-box}

body{
  background:radial-gradient(circle at top,#2a1f18,#140f0c 70%);
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  font-family:Inter,sans-serif;
  color:var(--text);
}

.screen{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  text-align:center;
  padding:40px;
  background:#140f0c;
}

.hidden{display:none}

button{
  background:var(--accent);
  border:none;
  padding:10px 20px;
  margin:6px;
  font-family:"IBM Plex Mono",monospace;
  cursor:pointer;
}

.cassette{
  width:min(420px,92vw);
  background:linear-gradient(145deg,#2b2019,#221912);
  border-radius:18px;
  padding:28px;
  text-align:center;
}

.label{
  background:var(--label);
  color:#1a140f;
  padding:8px 14px;
  font-family:"IBM Plex Mono",monospace;
  font-size:12px;
  border-radius:4px;
  margin-bottom:16px;
}

.meta{
  margin-top:18px;
  font-size:15px;
}

.tracklist{
  margin-top:14px;
  max-height:140px;
  overflow:auto;
  font-size:13px;
  opacity:.8;
}
.tracklist div{
  cursor:pointer;
  padding:4px;
}
.tracklist div:hover{
  color:var(--accent);
}
</style>
</head>

<body>

<div class="screen" id="intro">
  <div>This is something I made for you.</div>
  <button onclick="showTutorial()">Continue</button>
</div>

<div class="screen hidden" id="tutorial">
  <div style="max-width:400px">
    This is a digital cassette.<br><br>
    It plays from the first song to the last.<br>
    But if it ever gets stuck, you can switch songs.<br><br>
    Press play and let it run.
  </div>
  <button onclick="startCassette()">Insert Tape</button>
</div>

<div class="cassette hidden" id="cassette">

  <div class="label">SIDE A — FOR RIYA</div>

  <div class="meta" id="trackMeta"></div>

  <div>
    <button onclick="prevTrack()">PREV</button>
    <button onclick="togglePlay()" id="playBtn">PLAY</button>
    <button onclick="nextTrack()">NEXT</button>
  </div>

  <div class="tracklist" id="trackList"></div>

</div>

<audio id="audio" preload="auto"></audio>
<audio id="hiss" src="sounds/hiss.mp3"></audio>

<script>
const CROSSFADE = 6;

const playlist = [
 {title:"we're fucked, it's fine",src:"songs/we're fucked, it's fine.mp3"},
 {title:"Stay Down",src:"songs/Stay Down.mp3"},
 {title:"Annie's Song",src:"songs/Annie's Song.mp3"},
 {title:"By Your Side",src:"songs/By Your Side.mp3"},
 {title:"Afterthought",src:"songs/Afterthought.mp3"},
 {title:"Kaleji",src:"songs/Kaleji.mp3"},
 {title:"Gravity",src:"songs/Gravity.mp3"},
 {title:"Slide",src:"songs/Slide.mp3"},
 {title:"Backseat",src:"songs/Backseat.mp3"},
 {title:"Maybe So",src:"songs/Maybe So.mp3"}
];

let index = 0;
let playing = false;
let fadeInterval;

const audio = document.getElementById("audio");
const meta = document.getElementById("trackMeta");
const playBtn = document.getElementById("playBtn");
const hiss = document.getElementById("hiss");

function showTutorial(){
  intro.classList.add("hidden");
  tutorial.classList.remove("hidden");
}

function startCassette(){
  tutorial.classList.add("hidden");
  cassette.classList.remove("hidden");
  buildTrackList();
  loadTrack(index);
}

function buildTrackList(){
  const container = document.getElementById("trackList");
  container.innerHTML = "";
  playlist.forEach((track,i)=>{
    const div = document.createElement("div");
    div.textContent = (i+1) + ". " + track.title;
    div.onclick = ()=>{ index = i; loadTrack(index); if(playing) audio.play(); };
    container.appendChild(div);
  });
}

function loadTrack(i){
  audio.src = encodeURI(playlist[i].src);
  audio.load();
  meta.textContent = "Track " + String(i+1).padStart(2,"0") + " — " + playlist[i].title;
}

function fadeOut(callback){
  clearInterval(fadeInterval);
  fadeInterval = setInterval(()=>{
    if(audio.volume > 0.05){
      audio.volume -= 0.05;
    } else {
      clearInterval(fadeInterval);
      callback();
    }
  },50);
}

function fadeIn(){
  audio.volume = 0;
  fadeInterval = setInterval(()=>{
    if(audio.volume < 0.95){
      audio.volume += 0.05;
    } else {
      clearInterval(fadeInterval);
    }
  },50);
}

function nextTrack(){
  if(index < playlist.length - 1){
    fadeOut(()=>{
      index++;
      loadTrack(index);
      audio.play();
      fadeIn();
    });
  }
}

function prevTrack(){
  if(index > 0){
    fadeOut(()=>{
      index--;
      loadTrack(index);
      audio.play();
      fadeIn();
    });
  }
}

function togglePlay(){
  if(!playing){
    playing = true;
    playBtn.textContent = "PAUSE";
    hiss.play();
    audio.play();
  } else {
    playing = false;
    playBtn.textContent = "PLAY";
    audio.pause();
  }
}

audio.addEventListener("ended", nextTrack);
</script>

</body>
</html>
